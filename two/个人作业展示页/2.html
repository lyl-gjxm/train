<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
		<style>
			img{
				width:550px;
			}
		</style>
	</head>
	<body>
		<!-- <img class="lazy" src="loading.gif" data-src="g1.jpg" alt="">
		<img class="lazy" src="loading.gif" data-src="g1.jpg" alt="">
		<img class="lazy" src="loading.gif" data-src="g1.jpg" alt=""> -->
		<img src="loading.gif" data-src="g2.jpg" alt="">
		<img src="loading.gif" data-src="g3.jpg" alt="">
		<img  src="loading.gif"data-src="g1.jpg" alt="">
		<img src="loading.gif"data-src="g2.jpg" alt="">
		<img src="loading.gif"data-src="g3.jpg" alt="">
		<img src="loading.gif"data-src="g1.jpg" alt="">
		<img src="loading.gif" data-src="g2.jpg" alt="">
		<img src="loading.gif" data-src="g3.jpg" alt="">
		<img  src="loading.gif"data-src="g1.jpg" alt="">
		<img src="loading.gif"data-src="g2.jpg" alt="">
		<img src="loading.gif"data-src="g3.jpg" alt="">
		<img src="loading.gif"data-src="g1.jpg" alt="">
		<img src="loading.gif" data-src="g2.jpg" alt="">
		<img src="loading.gif" data-src="g3.jpg" alt="">
		<img  src="loading.gif"data-src="g1.jpg" alt="">
		<img src="loading.gif"data-src="g2.jpg" alt="">
		<img src="loading.gif"data-src="g3.jpg" alt="">
		<img src="loading.gif"data-src="g1.jpg" alt="">
	</body>
</html>
<script>
  function imgonload() {
    let img = document.querySelectorAll("img");
    /*console.log(img);*/
    for(let i=0; i<img.length; i++) {
      if(img[i].getBoundingClientRect().top < window.innerHeight) {
        //图片一旦有src就会加载出来，所以图片的路径不会放在src中，而是一个自定义的属性data-src中
        img[i].src = img[i].dataset.src;
      }
    }
  }

  function scollImg(fn) {
    let timer = null;
    let context = this;
    return function () {
      clearTimeout(timer);
      timer = setTimeout(() => {
        fn.apply(context);
      }, 500)
    }
  }
  window.onload = imgonload;
  window.onscroll = scollImg(imgonload);
</script>
